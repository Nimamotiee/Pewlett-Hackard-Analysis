--Deliverable ONE by Nima Motiee
--
--

-- Follow the instructions below to complete D1.
SELECT em.emp_no,
		em.first_name,
		em.last_name,
		t.title,
		t.from_date,
		t.to_date
INTO retiring_titles
FROM employees as em
INNER JOIN titles as t
ON (em.emp_no = t.emp_no)
WHERE (em.birth_date BETWEEN '1952-01-01' AND '1955-12-31')
ORDER by em.emp_no;

-- Use Distinct with Orderby to remove duplicate rows
SELECT DISTINCT ON (emp_no) 
emp_no,
first_name,
last_name,
title
INTO unique_titles
FROM retiring_titles
ORDER BY emp_no, title DESC;


-- Retrieve the number of employees by their most recent job title who are about to retire.
SELECT COUNT(ut.emp_no),
ut.title
INTO retirement_titles
FROM unique_titles as ut
GROUP BY title 
ORDER BY COUNT(title) DESC;






